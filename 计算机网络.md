## 计算机网络

### 概述

分组交换：将报文拆分成一系列的数据包，每个数据包加上头，依次并行发送至下一个结点，到目标地址再合并数据包

​		统计多路复用：分组序列不确定，按需共享链路

​		特点：适用于突发数据传输网络，但可能产生拥塞（分组延迟和丢失），需要协议处理可靠数据传输和拥塞控制

#### 性能

​			速率--数据率/比特率，单位时间传输比特量，单位b/s(bps)

​			带宽--数字同到所能传输的最高数据率，最高速率

​			延迟/时延--结点处理延迟（差错检测（丢包等）、确定输出链路）；排队延迟（等待链路可用、拥塞控制）；传输延迟（整组出结点）；传播延迟（第一个数据包到下一个数据包的时间）

​			时延带宽积--传播时延乘上带宽，指链路中最多含有的比特位，又称其为以比特为单位的链路长度

​			丢包--队列缓存容量有限，分组到达已满队列则被丢弃，丢包处理各不相同，可重发或忽略

​			吞吐量/率--发送端与接收端之间传送数据率，取决于小带宽链路即瓶颈链路

#### 计算机网络体系结构

简介：是计算机网络的各层及协议的集合， 从功能上描述网络结构，分层结构，每层使用下层服务，遵循某些网络协议完成本层功能，向上层提供服务，相邻层通过接口进行交互，模块化分层，易于标准化和系统更新、维护。

​		实体--任何可发送或接收信息的硬件或软件进程

​		协议--控制两个对等实体进行通信的规则集合

##### OSI参考模型

​		开放系统互连（OSI）参考模型，异构互连互通的国际标准，理论模型成功，市场失败，七个层次

​		物理层、数据链路层、网络层、传输层、会话层、表示层、应用层

​		数据封装--增加控制信息（构造协议数据单元），包括——地址，差错检测编码，协议控制（优先级、安全控制等）。

​		物理层：发送比特位，接口特性-机械、电气、功能、规程特性；比特编码-0，1表示；数据率；比特同步-时钟同步；传输模式-单半全双工

​		数据链路层：负责结点-结点数据传输，组帧，物理寻址，流量控制，差错控制，访问（接入）控制

​		网络层：负责源主机到目的主机数据分组交付。逻辑寻址（全局唯一），路由，分组转发

​		传输层：负责源-目的（端-端）（进程间）完整报文传输。报文分段与重组，SAP寻址（端号），连接控制，流量控制，差错控制

​		会话层：对话控制，同步，功能单薄

​		表示层：来自应用层，处理两个系统间交换信息的语法与语义问题。数据表示转化，加密解密、压缩/解压缩

​		应用层：支持用户通过用户代理或网络接口使用网络（服务），如文件传输（FTP)、电子邮件(SMTP)、Web（HTTP)....

##### TCP/IP参考模型

​		应用层：HTTP ... SMTP		 DNS ...  RTP

​		传输层：			TCP						UDP

​		网络层：							IP

​		网络接口层：各类接口，能在网络中发送IP封装的数据包

##### 五层参考模型

​		应用层：支持网络应用，FTP, SMTP, HTTP，向下传报文

​		传输层：进程-进程间的数据传输，TCP, UDP，生成段

​		网络层：源主机到目的主机的数据分组路由与转发，IP协议、路由协议等，生成数据报

​		数据链路层：相邻网络元素数据传输，以太网（Ethernet）、802.11（WiFi）、PPP，生成帧

​		物理层：比特传输

### 网络应用层

#### 体系结构

​		客户机/服务器结构(CS)：服务器永远在线，IP地址不变

​		点对点结构（P2P)：没有永远在线的服务器，任意端系统/结点可以直接通讯，节点间歇性接入网络，可能改变IP地址

​		混合结构：如Napster，文件传输用P2P结构，文件搜索用C/S结构

#### 网络应用进程通信

​		同一主机下--进程间通信机制，操作系统提供；不同主机--消息交换

​		套接字Socket：网络API，进程间发送/接收消息，类似于寄信，发送方将消息送至邮箱即可，传输基础设施向进程提供API

​		寻址进程：进程标识符--IP+端口号。寻址主机--IP地址；端口号--主机为需要通信的进程分配；

​		应用层协议：公开协议--HTTP，SMTP...；私有协议--多数P2P文件共享应用；

​					内容--消息类型（请求/响应），消息语法格式（字段及其描述），字段语义（字段含义），规则（何时/如何发送/响应）。

#### 网络应用的需求与传输层服务

##### 需求

​		数据丢失/可靠性；时间/延迟；带宽；.....

##### 传输层服务

​		TCP服务：面向连接--客户机/服务器进程间要建立连接；可靠的传输；流量控制--发送方不会发送过快，超过接收方处理能力；拥塞控制--网络负载过重时限制发送方的发送速度；不提供时间/延迟保障；不提供最小带宽保障；

​		UDP服务：无连接的；不可靠的数据传输--不提供可靠性保证、流量控制、拥塞控制、延迟保障及带宽保障

#### web应用

​		对象寻址：URL--统一资源定位器

```c
Scheme://host:port/path		
//scheme--协议，默认省略则为http；host:port--主机地址；path--文件地址
```

​		HTTP协议：超文本传输协议；C/S结构，客户请求、接收、展示web对象，服务器响应客户请求，发送对象；无状态

​						传输层协议：TCP传输服务--服务器在80端口等待客户请求，浏览器发起TCP连接，服务器接收TCP连接，交换HTTP，												关闭TCP连接。

​		HTTP连接：非持久性连接--每个TCP连接最多允许传输一个对象，传输后服务器关闭连接；

​								持久性连接--允许传输多个对象，建立TCP连接后，服务器保持连接打开，后续HTTP消息通过该连接发送；

​		HTTP消息格式：

​				请求消息：ASCII，人直接可读

```c
//请求行
GET /somedir/page.html HTTP/1.1				
//头部行
Host:主机地址
User-agent:浏览器类型
Connection:连接状态，如发送后是否关闭
Accept-language:接收语言
//换行说明结束

//消息体，可以发送数据，POST方法--在消息体中上传客户端的输入；URL方法，GET请求行中的URL字段上传输入信息
```

​				响应消息：

```htt
HTTP/1.1 200 OK	 //状态行，状态代码示例--200 OK;301 Moved Permanently;400 Bad Request;404 Not Found
//头部行
Connection: close							//连接状态
Data: Thu, 06 Aug 1998 12:00:15 GMT			//生成响应的时间
Server: Apache/1.3.0 (Unix)					//服务器软件类型
Last-Modified: Mon, 22 Jun 1998 ...			//上次修改时间
Content-Length: 6821						//内容长度
Content-Type:text/html						//内容类型
								//换行结束
data data data ...				//响应的数据
```

​		Cookie：HTTP协议无状态，不记录客户端之前请求，会话状态。Cookie技术用于记录HTTP前序操作，保存在客户端主机上的cookie文件由浏览器管理。用于身份认证、购物车、推荐，涉及隐私问题

​		web缓存/代理服务器技术：在不访问服务器的前提下满足客户端的HTTP请求。设置缓存服务器，同时充当客户端和服务器，客户端请求对象则先访问缓存，对象存在则直接返回，不存在则缓存服务器向原始服务器发送HTTP请求，获取对象返回给客户，同时自身也保存对象。

#### Email应用

​		构成：邮件客户端；邮件服务器（邮箱--存储发给该用户的email；消息队列--存储等待发送的email）；SMTP协议--邮件服务器之间传递消息所使用的协议（客户端是发送消息的服务器，服务器是接收消息的服务器）

​		运用：异步应用，不需双方在线，随时发送与接收

​		传输层协议：TCP，端口25，， 传输三阶段-握手；消息传输；关闭。

​		SMTP协议：持久性连接；消息由7位ASCII码构成；命令(ASCII)/响应(状态代码和语句)交互模式；SMTP服务器利用CRLF.CRLF确定消息的结束；

#### DNS应用

​		概述：Domain Name System域名解析系统，解决Internet上主机/路由器的识别问题--域名<->IP地址；多层命名服务器构成的分布式数据库，应用层协议；C/S架构；

​		服务：域名向IP地址的解释；主机别名；邮件服务器别名；负载均衡--web服务器；

​		迭代查询：被查询的域名服务器不认识该域名，返回高一级域名解析服务器的地址给客户端。

​		递归查询：被查询的域名服务器不认识该域名，递归至下一个服务器查询，查到了再返回给客户端

#### P2P应用

​		P2P概述：无服务器，任意端系统间通信，节点阶段性接入internet，节点可能更换IP地址。

#### socket编程

​		概述：套接字接口，位于应用层与传输层之间，一个进程有一个套接字；标识通信端口（对外）--IP地址+端口号；操作系统/进程管理套接字（对内）--套接字描述符；

​		socket抽象：类似于文件的抽象，进程创建套接字时，操作系统分配一个数据结构存储该套接字相关信息，返回套接字描述符。

```c
//地址结构sockaddr_in
struct sockaddr_in{
    u_char sin_len;				//地址长度
    u_char sin_family;			//地址族（TCP/IP:AF_INET）
    u_short sin_port;			//端口号
    struct in_addr sin_addr;	//IP地址
    char sin_zero[8];			//未用（置零）
}
```

​		TCP提供流（stream）和数据报（datagram）两种通信机制，所以套接字也分为流套接字和数据报套接字。

​		流套接字：SOCK_STREAM， 面向连接的，提供有序、可靠、双向字节流的连接。

​		数据报套接字：SOCK_DGRAM，不需要建立和维持一个连接，采用UDP/IP协议实现，不可靠的协议，速度快

​		通信过程：1）服务端程序将一个套接字绑定到指定端口，并通过此套接字等待和监听客户的连接请求

​							2）客户程序向服务端程序绑定的地址和端口发出连接请求

​							3）服务端接受连接请求

​							4）客户端和服务端通过读写套接字进行通信

### 传输层

#### 传输层服务

​		概述--为运行在不同host上的**进程间**提供了一种逻辑通信机制；端系统运行传输层协议；为应用提供多种协议(TCP/UDP)。

​		传输层协议：TCP--面向连接的、可靠的服务（连接、拥塞控制及流量控制）；UDP--无连接，不可靠；均不保证延迟及带宽

#### 多路复用和多路分用

​		接收端进行多路分用：传输层依据头部信息将收到的Segment交给正确的Socket，即不同的进程。一分多

​				主机接收到IP数据报（源IP地址、目的IP地址、传输层的段(Segment)），段中携带源端口号和目的端口号；

​				主机收到Segment后，传输层协议提取IP地址和端口号信息，将Segment导向相应的socket；

​				无连接分用：利用端口号创建socket：UDP的socket用二元组（目的IP地址、目的端口号）标识

​										  主机收到UDP段：检查端口号，将不同源的相同目的端口号UDP段导向绑定在该端口号的socket（多对一）

​				面向连接的分用：TCP的socket用四元组（源IP地址、目的IP地址、源端口号、目的端口号）标识

​													服务器可能同时支持多个TCP socket，每个socket用自己的四元组标识

​													web服务器为每个客户端打开不同的socket（一对一）

​		发送端进行多路复用：从多个Socket接收数据，为每块数据封装上头部信息，生成Segment，交给网络层。多复一

#### UDP协议

​		User Datagram Protocol，基于IP协议，复用/分用，简单的错误校验（端到端）；尽力而为的服务，可能丢失、非按序到达，无连接的；

​		存在意义--无需建立连接（减少延迟）、实现简单、头部开销小（8字节）、无拥塞控制（更好控制发送时间和速率）。

​		报文段格式：源端口号（16位）、目的端口号（16位）；段长度、校验和（错误校验）；消息；

​				校验和：检测UDP段在传输中是否发生错误。将段内容视为16位整数，计算所有整数和，进位则加在和的后面，得到的值按位取反便是校验和字段的值。发送方计算校验和，置入校验和字段，接收方计算校验和，并与字段中的校验和对比。

#### 可靠数据传输原理

​		 流水线机制：提高资源利用率，在收到ACK之前可连续发送多个分组；可能产生乱序到达；

​		滑动窗口协议：GBN、SR。窗口范围内是允许使用的序列号范围（已发送未确认和未发送可使用），窗口尺寸为N则最多有N个等待确认的消息；滑动窗口--随着协议运行，窗口在序列号空间内向前滑动。

##### 		GBN协议

​				发送方：分组头部包含K位序列号，窗口尺寸为N， ACK(n)--累计确认，确认到序列号n（含n）的分组均已被正确接收；超时事件--重传序列号大于等于n的所有分组。

​				接受方：ACK机制--发送拥有最高序列号且以被正确接收的分组的ACK；乱序到达的分组--接受方无缓存，直接丢弃，重新确认序列号最大的、按序到达的分组。

##### 	SR协议

​				接受方对每个分组单独进行确认（设置缓存机制，缓存乱序到达的分组）；发送方只重传未收到ACK的分组（为每个分组设置定时器）；发送方窗口--N个连续的序列号，限制已发送且为确认的分组。

​				接收方窗口--缓存乱序到达分组，等待未到达分组；

​				发送方：可用序列号在窗口中则发送，不在窗口中则等待；ACK机制--在窗口内则标记分组已接收，分组为窗口起始则窗口后移；	

​				接收方：分组在窗口范围则发送ACK，乱序则缓存，顺序则上传至上层，窗口移动；分组不在窗口范围内则依旧发送ACK(n)，说明只收到了n以前的，使其重传范围外的；其余情况则丢弃。

​				注意：发送方窗口尺寸Ns+接收方窗口尺寸Nr<=2^k

#### TCP协议

​		概述：点对点；可靠的、按序的字节流；流水线机制；发送方/接收方缓存；全双工；面向连接；流量控制机制；拥塞机制；

​		段结构：源端口、目标端口；序列号；确认序列号；头长度、未使用位、U(urgent data)、A(ACK)、P(push data now)、R()、SYN位、FIN位、接收窗口（愿意接收的字节数）；校验和、....。

​		序列号：segment中第一个字节的编号，建立TCP连接时，双方随机选择序列号；

​		ACKs：希望收到的下一字节的序列号；累计确认--该序列号之前的所有字节均已被正确收到。

```c
eg. ->seq= 42,ACK=79,data= 'c'		//字节序列号42，期望收到下一个序列号79，且79前的字节均已正确接收
    <-seq= 79,ACK=43,data= 'c'		//字节序列号79，期望收到下一个序列号43，且43前的字节均已正确接收
    ->seq= 43,ACK=80				//字节序列号43，期望收到下一个序列号80，且80前的字节均已正确接收
```

​		乱序到达的segme：协议中未规定，由TCP实现者做出决策。

##### TCP可靠数据传输

​		累计确认，使用单一重传定时器

​		发送方：从应用层收到数据--创建segment，序列号时segment第一个字节的编号，开启计时器，设置超时时间timeoutinterval

​						超时--重传引起超时的segment，重启定时器

​						收到ACK--更新sendbase，若窗口中还有未确认的分组，则重新启动定时器（单一定时器）

​		接收方：收到顺序分组，等待一会儿是否下一段来了，超时则ACK(n)，等到了则发最新的ACK(n+1)；乱序分组到达则立即重发上一个ACK，提示自己想要的还未到达。

​		快速重传机制：发送方收到同一数据的3个ACK，则假定该数据后的段已丢失，立即重传，可在定时器超时前即进行重传

##### 流量控制

​		接收方为TCP连接分配buffer，上层应用处理速度跟不上发送方速度时进行流量控制，避免数据溢出

​		实现：随时更新段中可接收字节大小的值，提醒发送方限制自己已经发送的但还未收到ACK的数据不超过接收方的空闲字节大小

##### 连接管理

​		三次握手：客户端发送SYN报文段（SYN位置一）请求连接--序列号随机，无数据

​							 服务器端发送SYNACK报文段--配置缓存，ACK初始序列号+1，即下一个希望收到的序列号

​							客户端收到SYNACK报文段，发送ACK报文段(SYN位置零)，可以包含数据(不发第三次，网络攻击)

​		四次分手：客户端发送FIN控制报文段

​							服务器收到FIN，回复ACK，

​							服务器关闭连接，发送FIN

​							客户端收到FIN，回复ACK，进入TIME_WAIT状态

​		客户端状态：close状态--send SYN--》SYN_SENT状态--receive SYNZ&ACK，send ACK--》ESTABLISHED状态--send FIN--》TIME_WAIT1状态--receive ACK--》TIME_WAIT2状态--receive FIN, send ACK--》TIME_WAIT状态--30s-》close状态

​		服务器状态：CLOSED状态--creats a listen socket->LISTEN状态--receive SYN, send SYN &ACK-->SYN_RCVD状态--receive ACK-->ESTABLISHED状态--receive FIN ， send ACK->CLOSE_WAIT状态--send FIN->LAST_ACK状态--receive ACK->CLOSED状态。

##### 拥塞控制

​		拥塞：链路中路由器接收、发送数据过大

​					表现--分组丢失（路由器缓存溢出），分组延迟过大（路由器缓存中排队）

​					控制：端到端拥塞控制--端系统观测丢失和延迟判断是否拥塞；

​								网络辅助的拥塞控制--路由器向发送方反馈网络用色信息，指示发送方应采取何种速率。

​		TCP控制拥塞：

​				发送方限制发送速率，设置congwin(拥塞窗口），速率rate=congwin/RTT，动态调整congwin反映所感知到的网络拥塞

​				感知拥塞--Loss事件（超时或3个重复的ACK）

​				调整发送速率--AIMD(加性增，乘性减), SS(慢启动)

​		AIMD：逐渐增加发送速率，探测可用带宽，直到发生loss，然后将congwin减半（锯齿行为）拥塞避免阶段

​		慢启动：初始速率很慢，但是快速攀升，指数增长congwin

​		Threshold变量：Loss事件发生时，Threshold被设置为loss事件前congwin值的1/2, 下次以该值为边界，慢启动转换为AIMD

​		Loss事件处理：3个重复ACKs（网络还能传输一些segment）--》congwin切为一半再线性增长；

​									timeout事件（拥塞更严重）--》congwin直接设置为1个MSS，然后指数增长，达到threadhold后，线性增长。

### 网络层

#### 网络层服务

​			从发送主机向接收主机发送数据报

​			发送主机--将数据段封装成数据报中；接收主机--向传输层交付数据段；每个主机和路由器都运行网络层协议；路由器检验所有穿越它的IP数据报的头部域。

​			核心功能：转发--将分组从路由器的输入端口转移到合适的输出端口，由转发表确定本路由器如何转发分组

​								 路由--确定分组从源到目的经过的路径（路由算法，确定通过网络的端到端路径）

​								 连接建立--某些网络（ATM）需要连接，数据分组传输前两端需要建立虚拟/逻辑连接（网络设备参与）

​			网络层服务模型：无连接服务--数据报网络，不事先为系列分组的传输确定路径；每个分组独立确定路径；

​											 连接服务--虚电路网络，传输前事先确定传输路径，沿路径传输分组，同系列分组路径相同，传输结束后拆除连接。

#### 虚电路网络

​		提供网络层连接服务，主机到主机服务

​		通信过程：呼叫建立-》数据传输-》拆除呼叫；每个分组携带虚电路标识（VC ID），而不是目的主机地址；链路、网络设备资源可以面向VC进行预分配。

​		VC转发表：VC路径上每个路由器都需要维护VC连接的状态信息，路由器通过转发表确定输入VCID链路应发送至哪个输出VCID链路

​		虚电路信令协议：确定路由路径，由于VC的建立、维护与拆除；

​				建立连接：发送主机初始呼叫-》呼叫到达接收主机-》接收主机接收呼叫-》返回信号确认呼叫建立

#### 数据报网络

​		提供网络层无连接服务，每个分组携带目的地址，路由器根据分组的目的地址转发分组--基于路由协议/算法构建转发表，每个分组独立选路

​		转发表：最长前缀匹配优先--在检索转发表时，优先选择与分组目的地址匹配前缀最长的入口

#### IPv4协议

##### 		数据报

​		首部+数据（TCP、UDP段）

​	首部：固定部分--版本号（4位）首部长度（4位）服务类型（8位）总长度（16位）；标识（16位）标志位（3位）片偏移（13位）；生存时间（8位）协议（8位）首部检验和（16位）；源IP地址（32位）；目的IP地址（32位）；

​				可变部分：选项字段（长度可变）；填充；

​	版本号：IP协议的版本号，4-》ipv4；6-》ipv6

​	首部长度：IP分组首部长度，以4字节（32位）为单位，4位最多为15*4=60字节

​	服务类型（TOS）：指示期望获得哪种类型的服务，网络提供区分服务时使用

​	总长度字段：IP分组的总字节数（首部+数据）字节为单位，最小IP分组长度=首部长度20B，最长IP分组总长度65535B

​	生存时间（TTL）：IP分组在网络中可以通过的路由器数（或跳步数），转发一次TTL减1，当为0时，路由器丢弃该IP分组

​	协议字段：指示IP分组封装的是哪个协议的数据包（6-》tcp/17-》udp），实现分解/复用

​	首部校验和：实现对IP分组首部的差错检测，计算校验和时，字段置全0，采用进位复加取反，逐跳计算逐跳校验

​	选项字段：长度可变，1~40B之间，携带安全、源选路径、时间戳和路由记录等内容。

​	填充字段：范围0~3B之间，保证首部符合32位对齐

##### 数据报分片

​	最大传输单元(MTU)--链路层数据帧可封装数据的上限，不同链路MTU不同

​	分片：将大的IP分组向小的MTU链路转发时，可以分片，分成多个小IP分组，IP分片到达目的主机后进行重组。

​	标识字段：标识一个IP分组，IP协议利用计数器，每产生IP分组计数器加一，作为该IP分组的标识

​	标志位：3位，保留位、DF位（1禁止分片，0允许分片）、MF位（1非最后一片，0最后一片）

​	片偏移：13位，一个IP分组分片封装原IP分组数据的相对偏移量（8字节为单位），封装分片，每片都为8字节倍数

##### IP编址

​	接口：主机/路由器与物理链路的连接

​	IP地址：32比特（ipv4），编号标识主机、路由器的接口，点分式每8位-》一个十进制数

​	IP子网：高位比特--网络号（netID），低位比特--主机号(HostID)，IP地址具有相同网络号的设备接口，不跨越路由器

##### 有类IP编址

​	A类地址：前8位为网络号，第一位固定位0，后24位为主机号，占50%，0.0.0.0~127.255.255.255

​	B类地址：前16位为网络号，前两位固定位10，后16位为主机号，占25%，128.0.0.0~191.255.255.255

​	C类地址：前24位为网络号，前三位固定位110，后8位为主机号，占12.5%，192.0.0.0~223.255.255.255

​	D类地址：前四位固定1110，占6.25

​	E类地址：前四位固定1111，占6.25，保留

##### IP子网与子网划分

​	原主机号中分配几位给SubID

​	子网掩码：32位，点分式，NetID、SubID位全取1，HostID位全取0

​			应用：将IP分组的目的IP地址与子网掩码按位与运算得到子网地址，保留NetID、SubID。

##### CIDR与路由聚合

​	CIDR无类域间路由：消除传统ABC类地址界限，格式-a.b.c.d/x，x位前缀长度

​	作用：提高ipv4地址空间分配效率；提高路由效率-路由聚合

##### DHCP协议

​	动态主机配置协议--从DHCP服务器动态获取（IP地址、子网掩码、默认网关地址、DNS服务器名称与IP地址），允许地址重用

​	实现：应用层使用，客户请求封装到UDP数据报中-》IP广播-》链路层广播-》DHCP服务器收到广播，构造ACK报文-》返回客户

##### NAT

​	网络地址转换（私有地址进入公共网络）

​	实现：替换--利用（NAT IP地址，新端口号）替换每个外出IP数据报的（源IP地址、源端口号）

​				 记录--将每对（NAT IP地址、新端口号）与（源IP地址、源端口号）的替换信息存储到NAT转换表中

​				替换--根据NAT转换表，利用（源ip地址、源端口号）替换每个进入内网IP数据报的（NAT IP地址，新端口号）

##### ICMP

​	互联网控制报文协议，支持主机或路由器--差错报告，网络探询

​	报文：差错报告报文--目的不可达；源抑制；超时/超期（TTL归零）；参数问题；重定向

​				 网络探询报文--回声请求与应答报文；时间戳请求与应答报文；

​	ICMP报文封装在IP数据报中数据部分传输，类型（8位）编码（8位）检验和（16位）；报文类型（32）；数据部分；

​			格式：类型+编码，eg. 0 0--回声应答；3 0--目的网络不可达；3 1--目的主机不可达；3 2--目的协议不可达；4 0--源抑制；11 0--TTL超期；

​	不发送ICMP报文情况：除第一个IP数据报分片外，后续分片不发送ICMP差错报文；特殊地址不发送；所有多播IP数据报；

##### IPv6

​	动机：32位ipv4地址空间分配殆尽；改进首部格式；移除校验和

​	格式：固定长度的40字节基本首部；不允许分片
