ARM Cortex-M处理器：32位寄存器、32位内部数据通路、32位总线接口，

M3和M4：三级流水线（取指、译码、执行），哈佛总线结构，取指和数据访问可以同时执行

​					  指令集为Thumb，通过Thumb-2技术，允许16位和32位指令混合使用

**两种操作状态**：调试状态--当处理器被暂停后，便会进入调试状态，并停止指令执行；

​							  Thumb状态--处理器执行程序指令（Thumb指令）时就处于Thumb状态

**两种操作模式**：处理模式--执行中断服务程序（ISR）等异常处理

​							  线程模式--执行普通应用程序代码是，处理器可处于特权访问或非特权访问模式，有特殊寄存器CONTROL控制

#### **寄存器**：

​				  R0~R12--通用目的寄存器，初始值未定义，前8个为低寄存器，许多16位指令只能访问低寄存器，高寄存器则可用于32位和几个16位指令

​				R13--栈指针（SP），通过PUSH和POP操作实现栈存储的访问，物理上存在两个栈指针，默认为主栈指针（MSP)，进程栈				指针（PSP)只能用于线程模式。

​				R14--链接寄存器（LR）， 用于函数或子程序调用时返回地址的保存

​				R15--程序计数器（PC），可读可写，读则返回当前指令地址加4，写则引起跳转操作

#### **特殊寄存器**：

​				程序状态寄存器（xPSR）--x=A， 应用PSR, x=E, 执行PSR；x=I, 中断PSR。

​				PRIMASK(可以禁止除HardFault和NMI外的所有异常) 、 FALULTMASK、BASEPRI寄存器，用于异常或中断

​				CONTROL寄存器--定义了栈指针的选择（主栈指针/进程栈指针）以及线程模式的访问等级（特权/非特权）

#### 存储器系统:

​				4GB线性地址空间；架构定义的存储器映射；支持大端和小端的存储器系统；位段访问；写缓存；存储器保护单元(MPU)；非对齐传输文件;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      

​				存储器映射：分区--程序代码访问、数据访问、外设、处理器的内部控制和调试部件。

​				栈存储：将系统主存用于栈空间操作，满递减模型，初始化为空间的最后位置；主栈指针（MSP)--复位默认使用，用于所有的异常处理；进程栈指针(PSP)--只能用于线程模式，通常用于运行嵌入式OS中的应用程序

​				存储器保护单元（MPU）：可选，通过定义特权和非特权访问权限来保护存储器区域。 

#### 异常和中断：

​				异常--会改变程序流的事件，暂停当前任务，转而执行异常处理程序，ARM中中断是异常的一种，中断的异常处理即中断服务程序(ISR)。

​				Cortex-M异常源：不可屏蔽中断(NMI)、中断(IRQ)、SysTick、系统异常

​				嵌套向量中断控制器(NVIC)：可编程，寄存器位与系统控制空间(SCS)，处理异常和中断配置、优先级以及中断配置；特性--灵活的异常和中断管理、支持嵌套、向量化的异常/中断入口、中断屏蔽。

​				向量表：为系统存储器内的字数据数组，每个元素代表一个异常类型的起始地址，异常均在Thumb状态下执行，所以所有异常向量的最低为都应该为1。

​				错误处理：总线错误、使用错误及存储器管理错误，默认是禁止的，可单独使能。处理器检测到错误时， 触发错误异常，所有错误处理都会触发HardFault异常，HardFault总是使能的。

​				系统控制块(SCB)：位于NVIC中，包含寄存器，用于控制处理器配置（如低功耗模式）、提供错误状态信息、向量表重定位。

#### 调试：

​				调试接口--调试适配器连接到Cortex-M微控制器控制调试特性和访问片上的存储器空间

​				跟踪接口--用于运行时手机处理器的信息，如数据、实践、概况信息或者程序执行的完整细节

#### 复位和复位流程：

​				上电复位：复位微控制器中的所有部分，包括处理器、调试支持部件和外设等

​				系统复位：复位处理器和外设，不包括处理器的调试支持部件

​				处理器复位：只复位处理器。

​					复位-->(0x00000000)取MSP初始值，设置主栈-->(0X00000004)取复位向量-->(复位向量表示的地址)取第一条指令

#### 指令集：

​				格式如下：label（标号）表示地址位置，可选；mnemonic（助记符），指令的名称，后跟操作符

```c
label
    mnemonic operand1, iperand2, ... ; 注释
```

#### 存储器系统：

​				简介：Cortex-M处理器可以对32位存储器进行寻址，存储空间可达2^32=4GB，多个总线接口，基于AMBA（高级微控制器总线架构）的总线接口设计；同时支持小端和大端的存储器系统；支持非对齐数据传输；支持排他传输；可位寻址的存储器空间（位段）；不同存储器区域的存储器属性和访问权限；可选的存储器保护单元。

​				存储器映射：代码区域--512MB，包括存储器第一部分默认的向量表； SRAM--512MB，支持位段（第一个MB）； 外设--512MB，第一个MB可位寻址； 外部RAM--两个512MB空间，用于片外存储器等其它RAM； 设备--两个512MB空间，用于片外外设等其它存储器； 系统--512MB，内部私有外设总线、外部私有外设总线及供应商定义区域。

​				连接处理器到存储器和外设：主要总线接口--AHB(AMBA高性能总线)Lite协议；code存储器区域独立于系统总线，数据访问和取指可同时进行，D-CODE总线访问，I-CODE总线取指及读向量表；私有外设总线--PPB不能用于外设总线

​				存储器的端：支持小端和大端，大多为小端(小字节在地址低端），在复位时确定存储器系统的端配置，复位前不会改变；取指总是处于小端模式，对SCS、调试部件和私有外设总线(PPB)区域访问总是小端的，可用REV、REVSH和ERV16等指令进行大小互换。

​				数据对齐和非对齐数据访问:存储器系统为32位，大小为32位（4字节，字）或16位（2字节，半字）可以对齐或非对齐；对齐传输指地址值为大小（字节为单位）的整数倍，字大小的对齐传输--4个字节对齐传输，访存时，传输地址隔4字节；栈操作、排他访问及位段操作不支持非对齐传输；非对齐传输时会拆分为多个对齐传输，会花费更多时钟周期；C编译在直接操作指针、_packed属性及内联/嵌入式汇编代码时可能出现非对齐传输，可设置配置控制寄存器中的UNALIGN_TRP（非对齐陷阱）位及系统控制块（SCB）中的CCR,使非对齐传输时触发异常。

##### 				位段操作：

​			简介--一次加载、存储操作可以访问（读/写）一个位，SRAM及外设区域的第一个1MB为位段区域，支持该操作；访问位段别名（位段操作）会引起对位段区域的访问；位段区域中每个字由位段别名地址区域32个字的LSB表示，访问位段别名地址时，该地址会被重映射到位段地址。

​			优势--每个任务的位访问是独立的，提高位操作速度（位段操作直接获得外设状态寄存器中的某位进行跳转）、实现从通用目的输入输出（GPIO)端口往串行设备的串行数据传输等。
